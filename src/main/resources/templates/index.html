<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>MobiUni - Mapa de Acessibilidade</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>
<nav class="navbar">
    <div class="navbar-logo">MobiUni</div>
    <ul class="navbar-menu">
        <li><button id="botao-contraste" class="botao-verde-menta">Alto Contraste</button></li>
        <li><a href="/mapa-offline">Mapa Offline</a></li>
        <li><a href="/comunidade">Comunidade</a></li>
        <li><a href="/sobrenos">Sobre NÃ³s</a></li>
        <li><a href="/register">Criar Conta</a></li>
        <li><a href="/login">Login</a></li>
    </ul>
</nav>

<div class="container-horizontal">
    <div class="mapa-esquerda">
        <div class="search-overlay">
            <input type="text" id="search" placeholder="Buscar bairro...">
            <button onclick="buscarLocal()">Buscar</button>
        </div>
        <div id="mapa"></div>
    </div>

    <div class="painel-infos" aria-label="InformaÃ§Ãµes sobre Acessibilidade">
        <h2>Mapa de Acessibilidade</h2>
        <!-- BotÃµes de acessibilidade logo apÃ³s a navbar -->
        <div class="leitura-acessivel">
            <button id="btn-leitura" aria-label="Ler conteÃºdo da pÃ¡gina">ðŸ”Š Ler PÃ¡gina</button>
            <button id="btn-parar" aria-label="Parar leitura em voz alta">â›” Parar Leitura</button>
        </div>
        <p>Explore os pontos de acessibilidade em diferentes bairros de SÃ£o LuÃ­s:</p>
        <ul id="listaBairros"></ul>
    </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    var mapa = L.map('mapa').setView([-2.523, -44.29], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap contributors'
    }).addTo(mapa);

    const pontosAcessibilidade = {
        "RenascenÃ§a": [
            { emoji: "â™¿", local: "Av. MiÃ©cimo da Silva", descricao: "Rampas de acesso em calÃ§adas amplas" },
            { emoji: "ðŸ¦¯", local: "Rua das DÃ¡lias", descricao: "Piso tÃ¡til ao longo da via" },
            { emoji: "ðŸ¦»", local: "Shopping SÃ£o LuÃ­s", descricao: "SinalizaÃ§Ã£o sonora nas entradas" },
            { emoji: "ðŸ§ ", local: "PraÃ§a RenascenÃ§a", descricao: "Ambiente calmo e com placas educativas" },
            { emoji: "â™¾ï¸", local: "Clube da FamÃ­lia", descricao: "EspaÃ§o sensorial para autistas" },
            { emoji: "ðŸ—¨ï¸", local: "Centro Empresarial", descricao: "SinalizaÃ§Ã£o em braile nos elevadores" }
        ],
        "Centro": [
            { emoji: "â™¿", local: "Rua Grande", descricao: "CalÃ§adas niveladas com rampas" },
            { emoji: "ðŸ¦¯", local: "Av. Pedro II", descricao: "SinalizaÃ§Ã£o tÃ¡til nas esquinas" },
            { emoji: "ðŸ¦»", local: "PalÃ¡cio dos LeÃµes", descricao: "Sistema de guia auditivo para visitantes" },
            { emoji: "ðŸ§ ", local: "Biblioteca PÃºblica", descricao: "EspaÃ§o inclusivo e silencioso" },
            { emoji: "â™¾ï¸", local: "Casa do MaranhÃ£o", descricao: "Ambiente adaptado para TEA" },
            { emoji: "ðŸ—¨ï¸", local: "Museu HistÃ³rico", descricao: "PainÃ©is em braile e pictogramas" }
        ],
        "BequimÃ£o": [
            { emoji: "â™¿", local: "Av. JerÃ´nimo de Albuquerque", descricao: "Rampas nas paradas de Ã´nibus" },
            { emoji: "ðŸ¦¯", local: "Rua 22", descricao: "Piso podotÃ¡til ao longo da rua" },
            { emoji: "ðŸ¦»", local: "Escola ComunitÃ¡ria", descricao: "SinalizaÃ§Ã£o visual e sonora" },
            { emoji: "ðŸ§ ", local: "PraÃ§a do BequimÃ£o", descricao: "Ambiente aberto e educativo" },
            { emoji: "â™¾ï¸", local: "Centro de SaÃºde", descricao: "Apoio e atendimento para TEA" },
            { emoji: "ðŸ—¨ï¸", local: "Unidade de CRAS", descricao: "Placas e pictogramas informativos" }
        ],
        "Cohama": [
            { emoji: "â™¿", local: "Av. Daniel de La Touche", descricao: "Rampas e travessias acessÃ­veis" },
            { emoji: "ðŸ¦¯", local: "Rua Boa EsperanÃ§a", descricao: "Placas de orientaÃ§Ã£o com braile" },
            { emoji: "ðŸ¦»", local: "Terminal Cohama", descricao: "Avisos sonoros de chegada" },
            { emoji: "ðŸ§ ", local: "PraÃ§a do Cohama", descricao: "Ambiente tranquilo e inclusivo" },
            { emoji: "â™¾ï¸", local: "Igreja Batista", descricao: "EspaÃ§o sensorial acolhedor" },
            { emoji: "ðŸ—¨ï¸", local: "ComÃ©rcio local", descricao: "Cartazes com pictogramas" }
        ],
        "Vinhais": [
            { emoji: "â™¿", local: "Rua do Aririzal", descricao: "Faixas com rampas niveladas" },
            { emoji: "ðŸ¦¯", local: "Rua Seis", descricao: "TÃ¡til em toda a calÃ§ada" },
            { emoji: "ðŸ¦»", local: "ColÃ©gio Dom Bosco", descricao: "Sistema de alerta auditivo" },
            { emoji: "ðŸ§ ", local: "PraÃ§a dos IpÃªs", descricao: "Ambiente verde e informativo" },
            { emoji: "â™¾ï¸", local: "Centro Infantil", descricao: "EspaÃ§o inclusivo para autistas" },
            { emoji: "ðŸ—¨ï¸", local: "Posto Vinhais", descricao: "Placas de atendimento acessÃ­vel" }
        ],
        "Anil": [
            { emoji: "â™¿", local: "Av. Casemiro JÃºnior", descricao: "Rampas largas e contÃ­nuas" },
            { emoji: "ðŸ¦¯", local: "Rua TrÃªs", descricao: "SinalizaÃ§Ã£o visual e piso tÃ¡til" },
            { emoji: "ðŸ¦»", local: "Igreja SÃ£o JosÃ©", descricao: "SinalizaÃ§Ã£o sonora nos cultos" },
            { emoji: "ðŸ§ ", local: "Parque Infantil", descricao: "Placas com figuras e apoio" },
            { emoji: "â™¾ï¸", local: "PraÃ§a Central", descricao: "Ãrea sensorial e inclusiva" },
            { emoji: "ðŸ—¨ï¸", local: "CEI Anil", descricao: "Pictogramas nos ambientes" }
        ],
        "Ponta d'Areia": [
            { emoji: "â™¿", local: "Av. dos Holandeses", descricao: "Rampas em toda a avenida" },
            { emoji: "ðŸ¦¯", local: "Praia de SÃ£o Marcos", descricao: "Piso podotÃ¡til atÃ© a areia" },
            { emoji: "ðŸ¦»", local: "Hotel Luzeiros", descricao: "Sistema de aviso luminoso" },
            { emoji: "ðŸ§ ", local: "Quiosque AcessÃ­vel", descricao: "Menu em figuras" },
            { emoji: "â™¾ï¸", local: "Deck dos Pescadores", descricao: "EspaÃ§o sensorial com som ambiente" },
            { emoji: "ðŸ—¨ï¸", local: "Ponte do Forte", descricao: "Placas com braile" }
        ],
        "Olho d'Ãgua": [
            { emoji: "â™¿", local: "Rua do Sol", descricao: "Rampas nas calÃ§adas" },
            { emoji: "ðŸ¦¯", local: "PraÃ§a do Olho d'Ãgua", descricao: "Piso tÃ¡til atÃ© os bancos" },
            { emoji: "ðŸ¦»", local: "Escola Estadual", descricao: "Sistema de guia auditivo" },
            { emoji: "ðŸ§ ", local: "Centro de Apoio", descricao: "EspaÃ§o silencioso" },
            { emoji: "â™¾ï¸", local: "Clube Social", descricao: "EspaÃ§o com estÃ­mulos suaves" },
            { emoji: "ðŸ—¨ï¸", local: "ComÃ©rcio da regiÃ£o", descricao: "Cartazes acessÃ­veis" }
        ],
        "Angelim": [
            { emoji: "â™¿", local: "Av. do Angelim", descricao: "Travessias acessÃ­veis" },
            { emoji: "ðŸ¦¯", local: "PraÃ§a do Anjo", descricao: "SinalizaÃ§Ã£o tÃ¡til em toda a praÃ§a" },
            { emoji: "ðŸ¦»", local: "Posto Angelim", descricao: "Alarme com luz e som" },
            { emoji: "ðŸ§ ", local: "Ãrea de Lazer", descricao: "Brinquedos educativos" },
            { emoji: "â™¾ï¸", local: "Centro Pastoral", descricao: "Apoio sensorial TEA" },
            { emoji: "ðŸ—¨ï¸", local: "Escola EsperanÃ§a", descricao: "Pictogramas nos corredores" }
        ],
        "Areinha": [
            { emoji: "â™¿", local: "Rua do Norte", descricao: "Rampas largas nas esquinas" },
            { emoji: "ðŸ¦¯", local: "Mercado da Areinha", descricao: "Guias para deficientes visuais" },
            { emoji: "ðŸ¦»", local: "Centro de ConvivÃªncia", descricao: "Sistema de som ambiente acessÃ­vel" },
            { emoji: "ðŸ§ ", local: "CEI Areinha", descricao: "Apoio Ã  deficiÃªncia intelectual" },
            { emoji: "â™¾ï¸", local: "PraÃ§a PÃºblica", descricao: "EspaÃ§o inclusivo e calmo" },
            { emoji: "ðŸ—¨ï¸", local: "CRAS Areinha", descricao: "InformaÃ§Ãµes em braile" }
        ]
    };

    const listaBairros = document.getElementById("listaBairros");

    Object.entries(pontosAcessibilidade).forEach(([bairro, pontos]) => {
        const item = document.createElement("li");
        item.innerHTML = `<strong>${bairro}</strong><ul>` + pontos.map(p => `<li>${p.emoji} <strong>${p.local}</strong> â€“ ${p.descricao}</li>`).join('') + `</ul>`;
        listaBairros.appendChild(item);

        pontos.forEach(ponto => {
            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${ponto.local}, SÃ£o LuÃ­s MA`)
                .then(res => res.json())
                .then(data => {
                    if (data.length > 0) {
                        const { lat, lon } = data[0];
                        L.marker([lat, lon]).addTo(mapa)
                            .bindPopup(`${ponto.emoji} <strong>${ponto.local}</strong><br>${ponto.descricao}`);
                    }
                });
        });
    });
</script>

<!-- VLibras Plugin -->
<div vw class="enabled">
    <div vw-access-button class="active"></div>
    <div vw-plugin-wrapper>
        <div class="vw-plugin-top-wrapper"></div>
    </div>
</div>
<script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
<script>new window.VLibras.Widget('https://vlibras.gov.br/app');</script>

<script>
    const botaoLeitura = document.getElementById('btn-leitura');

    botaoLeitura.addEventListener('click', () => {
      const texto = document.body.innerText;

      const utterance = new SpeechSynthesisUtterance(texto);
      utterance.lang = 'pt-BR';
      utterance.rate = 1;
      speechSynthesis.cancel(); // Interrompe se estiver lendo
      speechSynthesis.speak(utterance);
    });
</script>
<script>
    document.getElementById('btn-leitura').addEventListener('click', () => {
        const texto = document.body.innerText;
        const utterance = new SpeechSynthesisUtterance(texto);
        utterance.lang = 'pt-BR';
        speechSynthesis.cancel(); // Garante que reinicie
        speechSynthesis.speak(utterance);
    });

    document.getElementById('btn-parar').addEventListener('click', () => {
        speechSynthesis.cancel();
    });
</script>
<script>
    const btnLeitura = document.getElementById('btn-leitura');
    const btnParar = document.getElementById('btn-parar');

    // Atalhos de teclado
    document.addEventListener('keydown', (e) => {
        if (e.altKey && e.key.toLowerCase() === 'l') {
            btnLeitura.click(); // Alt + L â†’ Ler
        }
        if (e.altKey && e.key.toLowerCase() === 'p') {
            btnParar.click(); // Alt + P â†’ Parar
        }
    });
</script>
<script>
    const botaoContraste = document.getElementById("botao-contraste");

    // Verifica se hÃ¡ preferÃªncia salva no localStorage
    if (localStorage.getItem("contrasteAtivo") === "true") {
        document.body.classList.add("alto-contraste");
    }

    botaoContraste.addEventListener("click", () => {
        document.body.classList.toggle("alto-contraste");
        const ativo = document.body.classList.contains("alto-contraste");
        localStorage.setItem("contrasteAtivo", ativo);
    });

    function ativarContraste() {
    document.body.classList.add("alto-contraste");
}

function desativarContraste() {
    document.body.classList.remove("alto-contraste");
}

</script>

</body>
</html>
